# Custom Location logic for the Swindon sim

# Entry point rules
entry_point_rules:
  EUPBAD:
    list_to_delete_if_before: ['Westerleigh Jn']

  EDNMAIN:
    # The code will set the Marshfield entry point ot the mains by default. This logic can be used to set the entry to the reliefs if TT data suggests a train uses them.
    if_later_location_matching:
      # Conditons the train locations must match
      conditions:
        # The train must have newport as a location and the platform is 'URL' (up through line)
        - { 'location':'GORASTR', 'line': 'RL' }
        - OR
        - { 'location':'GORASTR', 'path': 'RL' }
        - OR
        - { 'location':'GORASTR', 'line': 'RL', 'plat': '3' }
        - OR
        - { 'location':'GORASTR', 'plat': '3' }
      # What will change if conditions are met.
      then:
        # Set entry to Marshfield Reliefs
        - entry_point: 'EDNRLF'
        # Remove 1st instance Marshfield location from train location list (needed for valid TT data)
        - remove_1st_of: [ 'Reading' ]


# Location rules
location_rules:
  'dummy location':
    # Rule not implemented yet.
    - if_x_y_z_then_delete_y:
        x: 'first'
        y: 'second'
        z: 'third'

  GORASTR:
    - if_particular_present:
        conditions:
          - { 'location':'GORASTR', 'line': 'RL' }
        then:
          - remove_props_from_location:  { 'location': 'GORASTR', props: ['line'] }


  'Didcot East Jn':
    - if_x_y_concurrent:
        x_conditions:
          - { 'location': 'Didcot East Jn', 'line': 'URL' }
        y_conditions:
          - { 'location': 'Didcot Parkway', 'plat': '4' }
        then:
          - modify_location:  { 'location': 'Didcot Parkway', 'path': 'URL' }

    - if_x_y_concurrent:
        x_conditions:
          - { 'location': 'Didcot East Jn', 'line': 'URL' }
        y_conditions:
          - { 'location': 'Didcot Parkway', 'plat': '5' }
        then:
          - modify_location: { 'location': 'Didcot Parkway', 'path': 'URL' }
#
#    - if_x_y_concurrent:
#        x_conditions:
#          - { 'location': 'Severn Tunnel Junction' }
#        y_conditions:
#          - { 'location': 'SEVTUGL' }
#        then:
#          - modify_location: { 'location': 'Severn Tunnel Junction', 'plat': '3' }